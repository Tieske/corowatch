<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>Luadocs for ./src/corowatch.lua</title>
    <link rel="stylesheet" href="../../../luadoc.css" type="text/css" />
    <!--meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/-->
</head>

<body>
<div id="container">

<div id="product">
    <div id="product_logo"></div>
    <div id="product_name"><big><b></b></big></div>
    <div id="product_description"></div>
</div> <!-- id="product" -->

<div id="main">

<div id="navigation">


<h2>LuaDoc</h2>
<ul>
	
	<li><a href="../../../index.html">Index</a></li>
	
</ul>


<!-- Module list -->

<h2>Modules</h2>
<ul>

	<li>
		<a href="../../../modules/corowatch.html">corowatch</a>
	</li>

</ul>



<!-- File list -->

<h2>Files</h2>
<ul>

	<li><strong>./src/corowatch.lua</strong></li>
	
</ul>






</div> <!-- id="navigation" -->

<div id="content">

<h1>File "<code>./src/corowatch.lua</code>"</h1>


<p>Module to watch coroutine executiontime. Coroutines running too long without yielding can be killed to prevent them from locking the Lua state. The module uses LuaSocket to get the time (socket.gettime() function). If you do not want that, override the coroutine.gettime() method with your own implementation. Copyright (c) 2013 - Thijs Schreijer, http://www.thijsschreijer.nl</p>








<h2>Functions</h2>
<table class="function_list">

    <tr>
    <td class="name" nowrap><a href="#coroutine.create">coroutine.create</a>&nbsp;(f)</td>
    <td class="summary">This is the same as the regular coroutine.create(), except that when the running coroutine is watched, then children spawned will also be watched with the same settings.</td>
    </tr>

    <tr>
    <td class="name" nowrap><a href="#coroutine.gettime">coroutine.gettime</a>&nbsp;()</td>
    <td class="summary">returns current time in seconds.</td>
    </tr>

    <tr>
    <td class="name" nowrap><a href="#coroutine.resume">coroutine.resume</a>&nbsp;(coro, ...)</td>
    <td class="summary">This is the same as the regular coroutine.resume().</td>
    </tr>

    <tr>
    <td class="name" nowrap><a href="#coroutine.status">coroutine.status</a>&nbsp;(coro)</td>
    <td class="summary">This is the same as the regular coroutine.status().</td>
    </tr>

    <tr>
    <td class="name" nowrap><a href="#coroutine.watch">coroutine.watch</a>&nbsp;(coro, tkilllimit, twarnlimit, cb)</td>
    <td class="summary">Protects a coroutine from running too long without yielding.</td>
    </tr>

    <tr>
    <td class="name" nowrap><a href="#coroutine.wrap">coroutine.wrap</a>&nbsp;(f)</td>
    <td class="summary">This is the same as the regular coroutine.wrap(), except that when the running coroutine is watched, then children spawned will also be watched with the same settings.</td>
    </tr>

    <tr>
    <td class="name" nowrap><a href="#coroutine.wrapf">coroutine.wrapf</a>&nbsp;(f, tkilllimit, twarnlimit, cb)</td>
    <td class="summary">This is the same as the regular coroutine.wrap(), except that the coroutine created is watched according to the parameters provided, and not according to the watch parameters of the currently running coroutine.</td>
    </tr>

    <tr>
    <td class="name" nowrap><a href="#coroutine.yield">coroutine.yield</a>&nbsp;(...)</td>
    <td class="summary">This is the same as the regular coroutine.yield().</td>
    </tr>

    <tr>
    <td class="name" nowrap><a href="#debug.sethook">debug.sethook</a>&nbsp;(coro, ...)</td>
    <td class="summary">This is the same as the regular debug.sethook(), except that when trying to set a hook on a coroutine that is being watched, if will throw an error.</td>
    </tr>

</table>


<br/>
<br/>




<h2><a name="functions"></a>Functions</h2>
<dl class="function">



<dt><a name="coroutine.create"></a><strong>coroutine.create</strong>&nbsp;(f)</dt>
<dd>
This is the same as the regular coroutine.create(), except that when the running coroutine is watched, then children spawned will also be watched with the same settings.


<h3>Parameters:</h3>
<ul>
	
	<li>
	  <code><em>f</em></code>: 
	</li>
	
</ul>











</dd>




<dt><a name="coroutine.gettime"></a><strong>coroutine.gettime</strong>&nbsp;()</dt>
<dd>
returns current time in seconds. If not overridden, it will require luasocket and use socket.gettime() to get the current time.












</dd>




<dt><a name="coroutine.resume"></a><strong>coroutine.resume</strong>&nbsp;(coro, ...)</dt>
<dd>
This is the same as the regular coroutine.resume().


<h3>Parameters:</h3>
<ul>
	
	<li>
	  <code><em>coro</em></code>: 
	</li>
	
	<li>
	  <code><em>...</em></code>: 
	</li>
	
</ul>











</dd>




<dt><a name="coroutine.status"></a><strong>coroutine.status</strong>&nbsp;(coro)</dt>
<dd>
This is the same as the regular coroutine.status().


<h3>Parameters:</h3>
<ul>
	
	<li>
	  <code><em>coro</em></code>: 
	</li>
	
</ul>











</dd>




<dt><a name="coroutine.watch"></a><strong>coroutine.watch</strong>&nbsp;(coro, tkilllimit, twarnlimit, cb)</dt>
<dd>
Protects a coroutine from running too long without yielding.


<h3>Parameters:</h3>
<ul>
	
	<li>
	  <code><em>coro</em></code>: coroutine to be protected
	</li>
	
	<li>
	  <code><em>tkilllimit</em></code>: (optional) time in seconds it is allowed to run without yielding
	</li>
	
	<li>
	  <code><em>twarnlimit</em></code>: (optional) time in seconds it is allowed before cb is called (must be smaller than tkilllimit)
	</li>
	
	<li>
	  <code><em>cb</em></code>: (optional) callback executed when the kill or warn limit is reached. The callback has 1 parameter (string value being either "warn" or "kill"), but runs on the coroutine that is subject of the warning. If the "warn" callback returns a truthy value (neither false, nor nil) the coro the timeouts for kill and warn limits will be reset (buying more time for the coroutine to finish its business). NOTE: the callback runs inside a debughook.
	</li>
	
</ul>





<div>


<h3 class="inline-block">Return value:</h3>
coro

</div>







</dd>




<dt><a name="coroutine.wrap"></a><strong>coroutine.wrap</strong>&nbsp;(f)</dt>
<dd>
This is the same as the regular coroutine.wrap(), except that when the running coroutine is watched, then children spawned will also be watched with the same settings. To set sepecific settings for watching use coroutine.wrapf()


<h3>Parameters:</h3>
<ul>
	
	<li>
	  <code><em>f</em></code>: 
	</li>
	
</ul>










<div>

<h3>See also:</h3>
<ul>
	
	<li><a href="../../../files/./src/corowatch.html#coroutine.wrapf">
		coroutine.wrapf
	</a></li>
	
</ul>

</div>


</dd>




<dt><a name="coroutine.wrapf"></a><strong>coroutine.wrapf</strong>&nbsp;(f, tkilllimit, twarnlimit, cb)</dt>
<dd>
This is the same as the regular coroutine.wrap(), except that the coroutine created is watched according to the parameters provided, and not according to the watch parameters of the currently running coroutine.


<h3>Parameters:</h3>
<ul>
	
	<li>
	  <code><em>f</em></code>: function to wrap
	</li>
	
	<li>
	  <code><em>tkilllimit</em></code>: see coroutine.create
	</li>
	
	<li>
	  <code><em>twarnlimit</em></code>: see coroutine.create
	</li>
	
	<li>
	  <code><em>cb</em></code>: see coroutine.create
	</li>
	
</ul>










<div>

<h3>See also:</h3>
<ul>
	
	<li><a href="../../../files/./src/corowatch.html#coroutine.create">
		coroutine.create
	</a></li>
	
	<li><a href="../../../files/./src/corowatch.html#coroutine.wrap">
		coroutine.wrap
	</a></li>
	
</ul>

</div>


</dd>




<dt><a name="coroutine.yield"></a><strong>coroutine.yield</strong>&nbsp;(...)</dt>
<dd>
This is the same as the regular coroutine.yield().


<h3>Parameters:</h3>
<ul>
	
	<li>
	  <code><em>...</em></code>: 
	</li>
	
</ul>











</dd>




<dt><a name="debug.sethook"></a><strong>debug.sethook</strong>&nbsp;(coro, ...)</dt>
<dd>
This is the same as the regular debug.sethook(), except that when trying to set a hook on a coroutine that is being watched, if will throw an error.


<h3>Parameters:</h3>
<ul>
	
	<li>
	  <code><em>coro</em></code>: 
	</li>
	
	<li>
	  <code><em>...</em></code>: 
	</li>
	
</ul>











</dd>


</dl>


</div> <!-- id="content" -->

</div> <!-- id="main" -->

<div id="about">
    <p><a href="http://validator.w3.org/check?uri=referer"><img src="http://www.w3.org/Icons/valid-xhtml10" alt="Valid XHTML 1.0!" height="31" width="88" /></a></p>
</div> <!-- id="about" -->

</div> <!-- id="container" -->
</body>
</html>
